@model OnlineScoping.ViewModels.HomeViewModel

@using Microsoft.AspNetCore.Identity
@using OnlineScoping.Models

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "Home Page";
}


<!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM STYLES -->
<link href="~/lib/layout/plugins/apex/apexcharts.css" rel="stylesheet" type="text/css">
<link href="~/lib/layout/assets/css/dashboard/dash_2.css" rel="stylesheet" type="text/css" class="dashboard-sales" />
<link href="~/lib/layout/plugins/file-upload/file-upload-with-preview.min.css" rel="stylesheet" />
<link href="~/lib/layout/assets/css/users/user-profile.css" rel="stylesheet" />
<!-- END PAGE LEVEL PLUGINS/CUSTOM STYLES -->
<style>
    .widget.widget-table-two.height-Scroll {
        height: 80vh;
    }

    .widget.widget-table-two.admin-scroll {
        height: 80vh;
        overflow-x: hidden;
        overflow-y: auto;
    }


    .model_btn {
        position: absolute;
        right: 4%;
        top: 0;
        bottom: 0;
        padding: 5px 0;
    }

    .model_btn1 {
        position: absolute;
        right: 20%;
        top: 0;
        bottom: 0;
        padding: 5px 0;
    }

    #withoutSpacing .card-header {
        background: #e5e5e5;
    }

    .model_icon {
        position: absolute;
        right: 36%;
        top: 27%;
    }

    .upload_btn.text-right {
        margin-right: 40px;
        padding: 10px;
    }
    /*.model_icon {
            position: absolute;
            right: 36%;
            top: 27%;
        }*/
    @@media only screen and (min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 1) {

        .model_icon {
            right: 45%;
        }

        .model_btn1 {
            right: 25%;
        }
    }

    @@media only screen and (min-device-width: 540px) and (max-device-width: 768px) and (-webkit-min-device-pixel-ratio: 1) {
        .model_icon {
            right: 60%;
        }

        .model_btn1 {
            right: 32%;
        }
    }

    @@media only screen and (min-device-width: 414px) and (max-device-height: 736px) and (-webkit-device-pixel-ratio: 3) {
        .model_icon {
            right: 25%;
            top: 7%;
        }

        .model_btn1 {
            position: unset;
        }

        .model_btn {
            position: unset;
        }
    }

    @@media only screen and (min-device-width: 375px) and (max-device-height: 812px) and (-webkit-device-pixel-ratio: 3) {

        .model_icon {
            right: 25%;
            top: 7%;
        }

        .model_btn1 {
            position: unset;
        }

        .model_btn {
            position: unset;
        }
    }

    @@media only screen and (min-device-width: 375px) and (max-device-width: 667px) and (-webkit-min-device-pixel-ratio: 2) {

        .model_icon {
            right: 25%;
            top: 7%;
        }

        .model_btn1 {
            position: unset;
        }

        .model_btn {
            position: unset;
        }
    }

    @@media only screen and (max-width: 360px) {
        .model_icon {
            right: 25%;
            top: 7%;
        }

        .model_btn1 {
            position: unset;
        }

        .model_btn {
            position: unset;
        }
    }

    .card-body {
        /* height: 400px;*/
        max-height: 400px;
        overflow-y: scroll;
        overflow-x: hidden;
    }

        .card-body::-webkit-scrollbar {
            width: 10px;
        }

    /* Track */
    ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
    }

    /* Handle */
    .card-body::-webkit-scrollbar-thumb {
        background: gray;
        border-radius: 10px;
    }

    /*second scrollbar*/
    .card-body::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    .card-body::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
    }

    /* Handle */
    .card-body::-webkit-scrollbar-thumb {
        background: gray;
        border-radius: 10px;
    }



    /*second div scroll*/
    .card-body::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
    }

    /* Handle */
    .card-body::-webkit-scrollbar-thumb {
        background: gray;
        border-radius: 10px;
    }

    /*second scrollbar*/
    .table-questionnair-1::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    .table-questionnair-1::-webkit-scrollbar-track {
        box-shadow: inset 0 0 5px grey;
        border-radius: 10px;
    }

    /* Handle */
    .table-questionnair-1::-webkit-scrollbar-thumb {
        background: gray;
        border-radius: 10px;
    }


    .table-questionnair-1 {
        /*        height: 300px;
    */ max-height: 300px;
        overflow-y: scroll;
        overflow-x: hidden;
    }

        .table-questionnair-1 table thead tr th:last-child {
            text-align: right !important;
            padding-right: 50px !important
        }

    .custom table thead tr th:last-child {
        text-align: right !important;
        padding-right: 140px !important
    }

    .custom .table > tbody > tr > td:last-child {
        text-align: right !important;
        padding-right: 140px !important;
    }
</style>
<div class="">
    @if (SignInManager.IsSignedIn(User))
    {
        <div class="layout-px-spacing">

            <div class="row layout-top-spacing">
                @if (User.IsInRole("Admin"))
                {

                    <div class="col-md-4 col-12 layout-spacing">
                        <div class="widget-three">
                            <div class="widget-heading">
                                <h5 class="">Summary</h5>
                            </div>
                            <div class="widget-content">

                                <div class="order-summary">

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shopping-bag"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index">
                                                <h6>Total Customers</h6>
                                                <p class="summary-count">@TempData["data"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-secondary" role="progressbar" style="width: @TempData["data"]%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index?val=email">
                                                <h6>Email Sent</h6>
                                                <p class="summary-count">@TempData["count"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-success" role="progressbar" style="width: @TempData["count"]%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-credit-card"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index?val=replied">
                                                <h6>Replied</h6>
                                                <p class="summary-count">@TempData["RepliedEmail"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-warning" role="progressbar" style="width: @TempData["RepliedEmail"]%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="col-md-8 col-12 layout-spacing">
                        <div class="widget widget-table-two admin-scroll">

                            <div class="widget-heading">
                                <h5 class="">Recent Activity</h5>
                            </div>

                            <div class="widget-content">
                                <div class="table-responsive">
                                    <table class="table" summary="Recent Activity">
                                        <thead>
                                            <tr>
                                                <th><div class="th-content">Customer</div></th>
                                                <th><div class="th-content th-heading">Created Date</div></th>
                                                <th><div class="th-content">Status</div></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.CustomerViewList)
                                            {
                                                <tr>
                                                    <td>
                                                        <div class=" customer-name font-weight-bold">@Html.DisplayFor(modelItem => item.FirstName)</div>
                                                    </td>

                                                    <td>
                                                        <div class=" text-center product-brand">@Html.DisplayFor(modelItem => item.CreatedDate)</div>
                                                    </td>
                                                    <td>
                                                        @if (item.IsEmailSent && item.CustomerQuestionnaircount == 0)
                                                        {
                                                            @if ((item.CurrentDateTime - item.SendDate).TotalSeconds > 86400)
                                                            {
                                                                <div class="font-weight-bold"><span class="badge outline-badge-primary">Email Sent</span>  <span class="" style="color:red" data-toggle="tooltip" data-placement="top" title="Customer not reviewed questionnaire within 24 hours"><em class="fas fa-exclamation-circle"></em></span></div>
                                                            }
                                                            else
                                                            {
                                                                <div class="font-weight-bold"><span class="badge outline-badge-primary">Email Sent</span></div>

                                                            }
                                                        }

                                                        else if (item.CustomerQuestionnaircount != 0)
                                                        {
                                                            @if (item.ProjectsViewList == 0)
                                                            {
                                                                <div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Unknown</a></span></div>
                                                            }
                                                            else
                                                            {
                                                                <div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Questionnaire Submitted</a></span></div>
                                                            }
                                                            @*<div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Questionnaire Submitted</a></span></div>*@

                                                        }
                                                        else
                                                        {
                                                            <div class="td-content"><span class="badge outline-badge-danger">Email Not Send</span></div>
                                                        }
                                                    </td>

                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                else if (User.IsInRole("Sales"))
                {
                    @if (TempData["AcceptProposalMsg"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["AcceptProposalMsg"]  </div>
                    }
                    @if (TempData["AcceptProposalErrerMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-danger mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["AcceptProposalErrerMessage"]  </div>
                    }
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-4 col-12 layout-spacing">
                        <div class="widget-three">
                            <div class="widget-heading">
                                <h5 class="">My Customer</h5>
                            </div>
                            <div class="widget-content">

                                <div class="order-summary">

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shopping-bag"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index">
                                                <h6>Total Customers</h6>
                                                <p class="summary-count">@TempData["data"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-secondary" role="progressbar" style="width: @TempData["data"]%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index?val=email">
                                                <h6>Email Sent</h6>
                                                <p class="summary-count">@TempData["count"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-success" role="progressbar" style="width: @TempData["count"]%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                    <div class="summary-list">
                                        <div class="w-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-credit-card"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>
                                        </div>
                                        <div class="w-summary-details">

                                            <a class="w-summary-info" href="/Customers/Index?val=replied">
                                                <h6>Replied</h6>
                                                <p class="summary-count">@TempData["RepliedEmail"]</p>
                                            </a>

                                            <div class="w-summary-stats">
                                                <div class="progress">
                                                    <div class="progress-bar bg-gradient-warning" role="progressbar" style="width: @TempData["RepliedEmail"]%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="col-xl-8 col-lg-8 col-md-4 col-sm-8 col-12 layout-spacing">
                        <div class="widget widget-table-two">

                            <div class="widget-heading">
                                <h5 class="">My Customer Recent Activity</h5>
                            </div>

                            <div class="widget-content">
                                <div class="table-responsive">
                                    <table class="table" summary="My Customer Recent Activity">
                                        <thead>
                                            <tr>
                                                <th><div class="th-content">Customer</div></th>
                                                <th><div class="th-content th-heading">Created Date</div></th>
                                                <th><div class="th-content">Status</div></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model.CustomerViewList.Count == 0)
                                            {
                                                <tr>
                                                    <td colspan="3" class="text-left pl-2">No data available</td>
                                                </tr>
                                            }
                                            else
                                            {
                                                @foreach (var item in Model.CustomerViewList)
                                                {
                                                    <tr>
                                                        <td>
                                                            <div class="font-weight-bold customer-name">@Html.DisplayFor(modelItem => item.FirstName)</div>
                                                        </td>

                                                        <td>
                                                            <div class="font-weight-bold text-center product-brand">@Html.DisplayFor(modelItem => item.CreatedDate)</div>
                                                        </td>
                                                        <td>
                                                            @if (item.IsEmailSent && item.CustomerQuestionnaircount == 0)
                                                            {
                                                                @if ((item.CurrentDateTime - item.SendDate).TotalSeconds > 86400)
                                                                {
                                                                    <div class="td-content"><span class="badge outline-badge-primary">Email Sent</span>  <span class="" style="color:red" data-toggle="tooltip" data-placement="top" title="Customer not reviewed questionnaire within 24 hours"><em class="fas fa-exclamation-circle"></em></span></div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="td-content"><span class="badge outline-badge-primary">Email Sent</span></div>

                                                                }
                                                            }
                                                            else if (item.CustomerQuestionnaircount != 0)
                                                            {
                                                                @if (item.ProjectsViewList == 0)
                                                                {
                                                                    <div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Unknown</a></span></div>
                                                                }
                                                                else
                                                                {
                                                                    <div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Project waiting for review</a></span></div>
                                                                }
                                                                @*<div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Project waiting for review</a></span></div>*@

                                                            }

                                                            else
                                                            {
                                                                <div class="td-content"><span class="badge outline-badge-success"><a asp-action="CustomerQuestionnair" asp-controller="Questionnaire" asp-route-id="@item.CustomerId">Email Not Send</a></span></div>
                                                            }
                                                        </td>

                                                    </tr>
                                                }

                                            }



                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                }
                else if (User.IsInRole("Customer"))
                {
                    @if (TempData["QuestionnaireSuccessMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> Questionnaire Save succesfully !  </div>
                    }
                    @if (TempData["CustomerQuestionnaireUpdateMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["CustomerQuestionnaireUpdateMessage"]   </div>
                    }
                    @if (TempData["CustomerQuestionnaireUpdateErrorMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-danger mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Error!</strong> @TempData["CustomerQuestionnaireUpdateErrorMessage"]  </div>
                    }
                    @if (TempData["ProjectMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["ProjectMessage"]  </div>
                    }
                    @if (TempData["ProjectErrerMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-danger mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Error!</strong> @TempData["ProjectErrerMessage"]  </div>
                    }

                    @if (TempData["RequestPraposalMsg"] != null)
                    {
                        <div style="margin: 0% 0% 0% 65%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["RequestPraposalMsg"]  </div>
                    }
                    @if (TempData["RequestPraposalErrorMsg"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-danger mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Error!</strong> @TempData["RequestPraposalErrorMsg"]  </div>
                    }
                    @if (TempData["UploadFileMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 65%;" class="alert alert-success mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Success!</strong> @TempData["UploadFileMessage"]  </div>
                    }
                    @if (TempData["UploadFileErrorMessage"] != null)
                    {
                        <div style="margin: 0% 0% 0% 70%;" class="alert alert-danger mb-4 delayMsg" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x close" data-dismiss="alert"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button> <strong>Error!</strong> @TempData["UploadFileErrorMessage"]  </div>
                    }
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 layout-spacing">
                        <div class="widget widget-table-two height-Scroll">
                            <div class="widget-heading row">

                                <div class="col-md-6">
                                    <h3 class="pt-3">
                                        Scope Requests
                                    </h3>
                                </div>
                                <div class="col-md-6 text-right">
                                    <a asp-action="CheckMail" asp-controller="Customers" style="display:none" data-toggle="tooltip" data-placement="top" title="Delete"><em class="far fa-trash-alt"></em></a>
                                    @*<a class="btn btn-primary ml-3 mt-3" data-toggle="modal" data-target="#QuestionnaireModal">Create New</a>*@
                                    <a class="btn btn-primary ml-3 mt-3" data-toggle="modal" data-target="#ProjectsModal">Create New Project</a>
                                </div>

                            </div>
                            <div class="widget-heading row">

                                <div class="col-md-6">
                                    <h6 class="pt-3">
                                        Projects
                                    </h6>
                                </div>
                                <div class="col-md-6 text-right">

                                </div>

                            </div>

                            <div class="widget-content">

                                <div id="withoutSpacing" class="">
                                    @if (Model.ProjectsViewList.Count == 0)
                                    {
                                        <div class="card">
                                            <div class="card-header">
                                                <section class="mb-0 mt-0">
                                                    <div role="menu" class="">
                                                        <div class="Accordion_text" id="" data-toggle="collapse" data-target="" aria-expanded="true" aria-controls="">
                                                            <span>Please Create New Project !</span>
                                                        </div>
                                                    </div>
                                                </section>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        @for (int i = 0; i < Model.ProjectsViewList.Count; i++)
                                        {
                                            @if (i == 0)
                                            {
                                                <div class="card">
                                                    <div class="card-header">
                                                        <section class="mb-0 mt-0">
                                                            <div role="menu" class="">
                                                                <div class="Accordion_text" id="heading_@i" data-toggle="collapse" data-target="#withoutSpacingAccordion_@i" aria-expanded="true" aria-controls="withoutSpacingAccordionOne">
                                                                    <div class="icons"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
                                                                    <span> @Model.ProjectsViewList[i].ProjectName </span>
                                                                </div>
                                                                @if (Model.ProjectsViewList[i].RequestStatus != null)
                                                                {
                                                                    <div class="col-md-4 align-self-center status-scop-head" style="position: absolute; right: 40%; top: 10; bottom: 0; padding: 5px 0;">
                                                                        <label>
                                                                            Status:
                                                                            @if (Model.ProjectsViewList[i].RequestStatus == "0")
                                                                            {
                                                                                @Html.Raw("No Status")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "1")
                                                                            {
                                                                                @Html.Raw("Request Awaiting Review")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "2")
                                                                            {
                                                                                @Html.Raw("Request Under Review")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "3")
                                                                            {
                                                                                @Html.Raw("Scope Finalised/Pre Req’s required")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "4")
                                                                            {
                                                                                @Html.Raw("Booking Confirmed")
                                                                            }
                                                                        </label>
                                                                    </div>
                                                                    @*<div class="">@Model.ProjectsViewList[i].RequestStatus</div>*@
                                                                }
                                                                <div class="model_icon" id="model_icon_action">
                                                                    <a data-toggle="modal" aria-expanded="false" data-target="#ProjectsModalUpdate" data-placement="top" title="Edit" onclick="BindProject('@Model.ProjectsViewList[i].ProjectsId','@Model.ProjectsViewList[i].ProjectName')"><em class="fas fa-pencil-alt"></em></a> |
                                                                    <a asp-action="DeleteProject" asp-controller="Customers" asp-route-id="@Model.ProjectsViewList[i].ProjectsId" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>
                                                                </div>

                                                                @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                {
                                                                    @*<div class="model_btn1"><a class="btn btn-primary" title="Request Praposal" data-toggle="modal" data-target="#ScopRequeModal_@i">Request Proposal</a> </div>*@
                                                                }
                                                                else
                                                                {
                                                                    @*<div class="model_btn1" id="proposal_btn"><a class="btn btn-primary" asp-action="RequestPraposal" asp-controller="Home" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId" data-toggle="modal" data-placement="top" title="Request Proposal" data-target="#myModal_@i">Request Proposal</a> </div>*@
                                                                }
                                                                <div class="model_btn"><a class="btn btn-primary" data-toggle="modal" data-target="#QuestionnaireModal_@i">Create New Scope</a> </div>
                                                            </div>
                                                        </section>
                                                    </div>

                                                    <div id="withoutSpacingAccordion_@i" class="collapse show" aria-labelledby="heading_@i" data-parent="#withoutSpacing">
                                                        <div class="upload_btn text-right">
                                                            <a class="btn btn-primary" onclick="SetUpload('@Model.ProjectsViewList[i].CustomerId ','@(Model.ProjectsViewList[i].ProjectsId)')" data-target="#UploadProposalModal" data-toggle="modal">Upload</a>
                                                        </div>

                                                        <div class="card-body">

                                                            <div class="table-responsive">
                                                                <div class="table-questionnair-1 custom">
                                                                    <table class="table  table-hover table-striped table-checkable table-highlight-head">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>
                                                                                    Projects Questionnairs
                                                                                </th>
                                                                                <th>Create Date</th>
                                                                                <th>QUESTIONNAIRE COMPLETED</th>
                                                                                <th>Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="4" class="text-left pl-2">No data available</td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                @foreach (var item in Model.ProjectsViewList[i].QDataList)
                                                                                {
                                                                                    <tr>
                                                                                        <td>
                                                                                            @Html.DisplayFor(modelItem => item.Nmae)
                                                                                        </td>
                                                                                        <td>
                                                                                            @Html.DisplayFor(modelItem => item.CreatedDate)
                                                                                        </td>

                                                                                        <td class="text-left">
                                                                                            @if (item.IsQuestionnaire == true)
                                                                                            {
                                                                                                <span><em style="color:green" class="fas fa-check"></em> |</span> <span><a asp-action="QuestionnaireResponseDetails" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-Projectid="@Model.ProjectsViewList[i].ProjectsId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-Page="HomeIndex">View</a></span>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <em style="color:red" class="fas fa-times"></em>
                                                                                            }
                                                                                        </td>

                                                                                        <td>
                                                                                            <a asp-action="UpdateQuestionnaires" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId" data-placement="top" title="Edit"><em class="fas fa-pencil-alt"></em></a> |
                                                                                            <a asp-action="DeleteCustomerQuestionnairs" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-Projectid="@Model.ProjectsViewList[i].ProjectsId" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>

                                                                                        </td>


                                                                                    </tr>
                                                                                }
                                                                            }


                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                            <div class="table-questionnair-1 custom">
                                                                <table summary="Additional Files" class="table  table-hover table-striped table-checkable table-highlight-head Proposals-list">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Additional Files
                                                                            </th>
                                                                            <th class="text-center pr-4">Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].UplodDocList == null)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="4" class="text-left pl-3">No data available</td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            @if (Model.ProjectsViewList[i].UplodDocList.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="4" class="text-left pl-3">No data available</td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                @foreach (var item in Model.ProjectsViewList[i].UplodDocList)
                                                                                {
                                                                                    <tr>
                                                                                        <td class="text-left pl-3">
                                                                                            <em class="fa fa-circle  fa-xs"></em>   @Html.DisplayFor(modelItem => item.FileName)
                                                                                        </td>
                                                                                        <td class="text-center pr-4 pl-2 ">
                                                                                            <a href="@item.FileContents" download id="download"><em class="fa fa-download"></em></a> |
                                                                                            <a asp-action="DeleteFiles" asp-controller="Home" asp-route-id="@item.UploadedDocumentsId" asp-route-customerId="@Model.CustomerId" style="font-size: 15px;" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>

                                                                                        </td>

                                                                                    </tr>
                                                                                }
                                                                            }
                                                                        }



                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="table-questionnair-1 custom">
                                                                <table summary="Procheckup Uploads" class="table  table-hover table-striped table-checkable table-highlight-head Proposals-list">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Procheckup Uploads
                                                                            </th>
                                                                            <th class="text-center pr-4">Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].ProchekupUploadList == null)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="4" class="text-left pl-3">No data available</td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            @if (Model.ProjectsViewList[i].ProchekupUploadList.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="4" class="text-left pl-3">No data available</td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                @foreach (var item in Model.ProjectsViewList[i].ProchekupUploadList)
                                                                                {
                                                                                    <tr>
                                                                                        <td class="text-left pl-3">
                                                                                            <em class="fa fa-circle  fa-xs"></em>   @Html.DisplayFor(modelItem => item.FileName)
                                                                                        </td>
                                                                                        <td class="text-center pr-4 pl-2 ">
                                                                                            <a href="@item.FileContents" download id="download"><em class="fa fa-download"></em></a> @*|*@
                                                                                            @*<a asp-action="DeleteProchechkupUploadsFiles" asp-controller="Home" asp-route-id="@item.UploadedDocumentsId" asp-route-customerId="@Model.CustomerId" style="font-size: 15px;" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>*@

                                                                                        </td>

                                                                                    </tr>
                                                                                }
                                                                            }
                                                                        }



                                                                    </tbody>
                                                                </table>
                                                            </div>




                                                        </div>
                                                    </div>
                                                </div>


                                                <!-- Modal -->
                                                <div class="modal fade" id="QuestionnaireModal_@i" tabindex="-1" role="dialog" aria-labelledby="QuestionnaireModal" aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content" style=" height: 500px;">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">Scope Questionnaires</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body table-responsive">
                                                                <div class="table-questionnair-1">

                                                                    <table summary="Scope Questionnaires" class="table  table-hover table-striped table-checkable table-highlight-head">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>
                                                                                    Name
                                                                                </th>
                                                                                <th></th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                            {
                                                                                @foreach (var item in Model.QuestionnaireList)
                                                                                {
                                                                                    <tr>
                                                                                        <td>
                                                                                            @Html.DisplayFor(modelItem => item.Name)
                                                                                        </td>
                                                                                        <td>
                                                                                            <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Select</a>
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                            }
                                                                            else
                                                                            {


                                                                                @foreach (var item in Model.QuestionnaireList)
                                                                                {
                                                                                    var abc = 0;
                                                                                    <tr>
                                                                                        <td>
                                                                                            @Html.DisplayFor(modelItem => item.Name)
                                                                                        </td>
                                                                                        <td>


                                                                                            @foreach (var item1 in Model.ProjectsViewList[i].QDataList)
                                                                                            {

                                                                                                @if (item.QuestionnaireId == item1.QuestionnaireId)
                                                                                                {
                                                                                                    abc = 1;
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                    @*<a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-CustomerId="">Select</a>*@
                                                                                                }
                                                                                            }


                                                                                            @if (abc == 1)
                                                                                            {
                                                                                                <span>Select</span>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Select</a>
                                                                                            }

                                                                                        </td>
                                                                                    </tr>

                                                                                }
                                                                            }

                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">

                                                                <button type="button" class="btn" data-dismiss="modal">Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="modal fade" id="ScopRequeModal_@i" tabindex="-1" role="dialog" aria-labelledby="QuestionnaireModal" aria-hidden="true">
                                                    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                                                        <div class="modal-content" style=" ">

                                                            <div class="modal-body pt-5 pb-3 px-3">
                                                                <p class="mb-3">
                                                                    A new scope needs to be created first by clicking the "Create New Scope".
                                                                </p>
                                                                <button type="button" class="btn btn-sm float-lg-right" data-dismiss="modal">Close</button>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="myModal_@i" tabindex="-1" role="dialog" class="modal fade">
                                                    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                                                        <div class="modal-content">

                                                            <div class="modal-body text-center pt-5 pb-3 px-3">
                                                                <p class="mb-3">Are you sure to send proposal request?</p>
                                                                <a class="btn btn-primary btn-sm" asp-action="RequestPraposal" asp-controller="Home" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Yes</a>
                                                                <button type="button" class="btn btn-sm" data-dismiss="modal">No</button>
                                                            </div>


                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                            else
                                            {


                                                <div class="card">
                                                    <div class="card-header">
                                                        <section class="mb-0 mt-0">
                                                            <div role="menu" class="">
                                                                <div class="Accordion_text" id="headingOne_@i" data-toggle="collapse" data-target="#withoutSpacingAccordion_@i" aria-expanded="true" aria-controls="withoutSpacingAccordionOne">
                                                                    <div class="icons"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
                                                                    <span> @Model.ProjectsViewList[i].ProjectName </span>
                                                                </div>
                                                                @if (Model.ProjectsViewList[i].RequestStatus != null)
                                                                {
                                                                    <div class="col-md-4 align-self-center status-scop-head" style="position: absolute; right: 40%; top: 10; bottom: 0; padding: 5px 0;">
                                                                        <label>
                                                                            Status:
                                                                            @if (Model.ProjectsViewList[i].RequestStatus == "0")
                                                                            {
                                                                                @Html.Raw("No Status")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "1")
                                                                            {
                                                                                @Html.Raw("Request Awaiting Review")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "2")
                                                                            {
                                                                                @Html.Raw("Request Under Review")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "3")
                                                                            {
                                                                                @Html.Raw("Scope Finalised/Pre Req’s required")
                                                                            }
                                                                            else if (Model.ProjectsViewList[i].RequestStatus == "4")
                                                                            {
                                                                                @Html.Raw("Booking Confirmed")
                                                                            }
                                                                        </label>
                                                                    </div> @*<div class="">@Model.ProjectsViewList[i].RequestStatus</div>*@
                                                                }
                                                                <div class="model_icon">
                                                                    <a data-toggle="modal" aria-expanded="false" data-target="#ProjectsModalUpdate" data-placement="top" title="Edit" onclick="BindProject('@Model.ProjectsViewList[i].ProjectsId','@Model.ProjectsViewList[i].ProjectName')"><em class="fas fa-pencil-alt"></em></a> |
                                                                    <a asp-action="DeleteProject" asp-controller="Customers" asp-route-id="@Model.ProjectsViewList[i].ProjectsId" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>
                                                                </div>
                                                                @*<div class="model_btn1"><a class="btn btn-primary" asp-action="RequestPraposal" asp-controller="Home" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId" data-toggle="modal" data-placement="top" title="Request Proposal" data-target="#myModal_@i"  >Request Proposal</a> </div>*@

                                                                @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                {
                                                                    @*<div class="model_btn1"><a class="btn btn-primary" title="Request Praposal" data-toggle="modal" data-target="#ScopRequeModal_@i">Request Proposal</a> </div>*@
                                                                }
                                                                else
                                                                {
                                                                    @*<div class="model_btn1"><a class="btn btn-primary" asp-action="RequestPraposal" asp-controller="Home" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId" data-toggle="modal" data-placement="top" title="Request Proposal" data-target="#myModal_@i">Request Proposal</a> </div>*@
                                                                }


                                                                <div class="model_btn"><a class="btn btn-primary" data-toggle="modal" data-target="#QuestionnaireModal_@i">Create New Scope</a> </div>
                                                            </div>
                                                        </section>
                                                    </div>

                                                    <div id="withoutSpacingAccordion_@i" class="collapse" aria-labelledby="heading_@i" data-parent="#withoutSpacing">
                                                        <div class="upload_btn text-right">
                                                            <a class="btn btn-primary" onclick="SetUpload('@Model.ProjectsViewList[i].CustomerId ','@(Model.ProjectsViewList[i].ProjectsId)')" data-target="#UploadProposalModal" data-toggle="modal">Upload</a>
                                                        </div>

                                                        <div class="card-body">

                                                            <div class="table-responsive table-questionnair-1 custom">
                                                                <table summary="Projects View List" class="table  table-hover table-striped table-checkable table-highlight-head">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Projects Questionnairs
                                                                            </th>
                                                                            <th>Create Date</th>
                                                                            <th>QUESTIONNAIRE COMPLETED</th>
                                                                            <th>Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="4" class="text-left pl-2">No data available</td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            @foreach (var item in Model.ProjectsViewList[i].QDataList)
                                                                            {
                                                                                <tr>
                                                                                    <td>
                                                                                        @Html.DisplayFor(modelItem => item.Nmae)
                                                                                    </td>
                                                                                    <td>
                                                                                        @Html.DisplayFor(modelItem => item.CreatedDate)
                                                                                    </td>

                                                                                    <td class="text-left">
                                                                                        @if (item.IsQuestionnaire == true)
                                                                                        {
                                                                                            <span><em style="color:green" class="fas fa-check"></em> |</span> <span><a asp-action="QuestionnaireResponseDetails" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-Projectid="@Model.ProjectsViewList[i].ProjectsId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-Page="HomeIndex">View</a></span>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <em style="color:red" class="fas fa-times"></em>
                                                                                        }
                                                                                    </td>
                                                                                    <td>
                                                                                        <a asp-action="UpdateQuestionnaires" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId" data-placement="top" title="Edit"><em class="fas fa-pencil-alt"></em></a> |
                                                                                        <a asp-action="DeleteCustomerQuestionnairs" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-Projectid="@Model.ProjectsViewList[i].ProjectsId" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>

                                                                                    </td>

                                                                                </tr>
                                                                            }
                                                                        }


                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="table-questionnair-1 custom">


                                                                <table summary="Proposals-list" class="table  table-hover table-striped table-checkable table-highlight-head Proposals-list">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Additional Files
                                                                            </th>
                                                                            <th class="text-center pr-4">Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].UplodDocList == null)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="4" class="text-left pl-3">No data available</td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            @if (Model.ProjectsViewList[i].UplodDocList.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="4" class="text-left pl-3">No data available</td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                @foreach (var item in Model.ProjectsViewList[i].UplodDocList)
                                                                                {
                                                                                    <tr>
                                                                                        <td class="text-left pl-3">
                                                                                            <em class="fa fa-circle  fa-xs"></em>   @Html.DisplayFor(modelItem => item.FileName)
                                                                                        </td>
                                                                                        <td class="text-center pr-4 pl-2 ">
                                                                                            <a href="@item.FileContents" download id="download"><em class="fa fa-download"></em></a>
                                                                                            <a asp-action="DeleteFiles" asp-controller="Home" asp-route-id="@item.UploadedDocumentsId" asp-route-customerId="@Model.CustomerId" style="font-size: 15px;" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>

                                                                                        </td>

                                                                                    </tr>
                                                                                }
                                                                            }
                                                                        }


                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="table-questionnair-1 custom">
                                                                <table summary="Procheckup Uploads" class="table  table-hover table-striped table-checkable table-highlight-head Proposals-list">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Procheckup Uploads
                                                                            </th>
                                                                            <th class="text-center pr-4">Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].ProchekupUploadList == null)
                                                                        {
                                                                            <tr>
                                                                                <td colspan="4" class="text-left pl-3">No data available</td>
                                                                            </tr>
                                                                        }
                                                                        else
                                                                        {
                                                                            @if (Model.ProjectsViewList[i].ProchekupUploadList.Count == 0)
                                                                            {
                                                                                <tr>
                                                                                    <td colspan="4" class="text-left pl-3">No data available</td>
                                                                                </tr>
                                                                            }
                                                                            else
                                                                            {
                                                                                @foreach (var item in Model.ProjectsViewList[i].ProchekupUploadList)
                                                                                {
                                                                                    <tr>
                                                                                        <td class="text-left pl-3">
                                                                                            <em class="fa fa-circle  fa-xs"></em>   @Html.DisplayFor(modelItem => item.FileName)
                                                                                        </td>
                                                                                        <td class="text-center pr-4 pl-2 ">
                                                                                            <a href="@item.FileContents" download id="download"><em class="fa fa-download"></em></a>
                                                                                            @*<a asp-action="DeleteProchechkupUploadsFiles" asp-controller="Home" asp-route-id="@item.UploadedDocumentsId" asp-route-customerId="@Model.CustomerId" style="font-size: 15px;" data-toggle="tooltip" data-placement="top" title="Delete" onclick="return confirm('Are you sure you want to delete this?')"><em class="far fa-trash-alt"></em></a>*@

                                                                                        </td>

                                                                                    </tr>
                                                                                }
                                                                            }
                                                                        }



                                                                    </tbody>
                                                                </table>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>


                                                <!-- Modal -->
                                                <div class="modal fade" id="QuestionnaireModal_@i" tabindex="-1" role="dialog" aria-labelledby="QuestionnaireModal" aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content" style=" height: 500px;">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">Scope Questionnaires</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body table-responsive">
                                                                <table summary="Scope Questionnaires" class="table  table-hover table-striped table-checkable table-highlight-head">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>
                                                                                Name
                                                                            </th>
                                                                            <th></th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @if (Model.ProjectsViewList[i].QDataList.Count == 0)
                                                                        {
                                                                            @foreach (var item in Model.QuestionnaireList)
                                                                            {
                                                                                <tr>
                                                                                    <td>
                                                                                        @Html.DisplayFor(modelItem => item.Name)
                                                                                    </td>
                                                                                    <td>
                                                                                        <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Select</a>
                                                                                    </td>
                                                                                </tr>
                                                                            }
                                                                        }
                                                                        else
                                                                        {


                                                                            @foreach (var item in Model.QuestionnaireList)
                                                                            {
                                                                                var abc = 0;
                                                                                <tr>
                                                                                    <td>
                                                                                        @Html.DisplayFor(modelItem => item.Name)
                                                                                    </td>
                                                                                    <td>


                                                                                        @foreach (var item1 in Model.ProjectsViewList[i].QDataList)
                                                                                        {

                                                                                            @if (item.QuestionnaireId == item1.QuestionnaireId)
                                                                                            {
                                                                                                abc = 1;
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                @*<a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-CustomerId="">Select</a>*@
                                                                                            }
                                                                                        }


                                                                                        @if (abc == 1)
                                                                                        {
                                                                                            <span>Select</span>
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Select</a>
                                                                                        }

                                                                                    </td>
                                                                                </tr>

                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="modal-footer">

                                                                <button type="button" class="btn" data-dismiss="modal">Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div id="myModal_@i" tabindex="-1" role="dialog" class="modal fade">
                                                    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                                                        <div class="modal-content">

                                                            <div class="modal-body text-center pt-5 pb-3 px-3">
                                                                <p class="mb-3">Are you sure to send proposal request?</p>
                                                                <a class="btn btn-primary btn-sm" asp-action="RequestPraposal" asp-controller="Home" asp-route-ProjectId="@Model.ProjectsViewList[i].ProjectsId">Yes</a>
                                                                <button type="button" class="btn btn-sm" data-dismiss="modal">No</button>
                                                            </div>


                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="modal fade" id="ScopRequeModal_@i" tabindex="-1" role="dialog" aria-labelledby="QuestionnaireModal" aria-hidden="true">
                                                    <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                                                        <div class="modal-content" style=" ">

                                                            <div class="modal-body pt-5 pb-3 px-3">
                                                                <p class="mb-3">
                                                                    A new scope needs to be created first by clicking the "Create New Scope".
                                                                </p>
                                                                <button type="button" class="btn btn-sm float-lg-right" data-dismiss="modal">Close</button>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            }}
                                    }
                                </div>






                                @*<div class="table-responsive">
                                        <table  summary="QUESTIONNAIRE " class="table  table-hover table-striped table-checkable table-highlight-head">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        Name
                                                    </th>
                                                    <th>Create Date</th>
                                                    <th>QUESTIONNAIRE COMPLETED</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model.CustomerQuestionnairList.Count == 0)
                                                {
                                                    <tr>
                                                        <td colspan="3" class="text-left">No data available</td>
                                                    </tr>
                                                }
                                                else
                                                {
                                                    @foreach (var item in Model.CustomerQuestionnairList)
                                                    {
                                                        <tr>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.Nmae)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(modelItem => item.CreatedDate)
                                                            </td>

                                                            <td class="text-left">
                                                                @if (item.IsQuestionnaire == true)
                                                                {
                                                                    <span><em style="color:green" class="fas fa-check"></em> |</span> <span><a asp-action="QuestionnaireResponseDetails" asp-controller="Questionnaire" asp-route-id="@item.CustomerId" asp-route-QuestionnaireId="@item.QuestionnaireId" asp-route-Page="HomeIndex">View</a></span>
                                                                }
                                                                else
                                                                {
                                                                    <em style="color:red" class="fas fa-times"></em>
                                                                }
                                                            </td>

                                                        </tr>
                                                    }
                                                }


                                            </tbody>
                                        </table>
                                    </div>*@
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    }
</div>


<!-- Modal -->
@*<div class="modal fade" id="QuestionnaireModal" tabindex="-1" role="dialog" aria-labelledby="QuestionnaireModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content" style=" height: 500px;">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Scope Questionnaires</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="modal-body table-responsive">
                    <table summary="Customer Questionnair List " class="table  table-hover table-striped table-checkable table-highlight-head">
                        <thead>
                            <tr>
                                <th>
                                    Name
                                </th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.CustomerQuestionnairList.Count == 0)
                            {
                            @foreach (var item in Model.QuestionnaireList)
                                {
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Name)
                                </td>
                                <td>
                                    <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-CustomerId="">Select</a>
                                </td>
                            </tr>
                                }
                            }
                            else
                            {


                            @foreach (var item in Model.QuestionnaireList)
                                {
                                    var abc = 0;
                            <tr>
                                <td>
                                    @Html.DisplayFor(modelItem => item.Name)
                                </td>
                                <td>


                                    @foreach (var item1 in Model.CustomerQuestionnairList)
                                            {

                                    @if (item.QuestionnaireId == item1.QuestionnaireId)
                                                {
                                                    abc = 1;
                                                }
                                                else
                                                {
                                    <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-CustomerId="">Select</a>
                                                }
                                            }


                                    @if (abc == 1)
                                            {
                                    <span>Select</span>
                                            }
                                            else
                                            {
                                    <a asp-action="ModuleWiseQuestions" asp-controller="Questionnaire" asp-route-id="@item.QuestionnaireId" asp-route-CustomerId="">Select</a>
                                            }

                                </td>
                            </tr>

                                }
                            }

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>*@


<div class="modal fade bd-example-modal-lg" id="ProjectsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <form asp-action="AddProject" asp-controller="Customers" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add New Project</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label asp-for="@Model.ProjectsViewData.ProjectName" class="control-label"></label>
                                <input asp-for="@Model.ProjectsViewData.ProjectName" class="form-control" />
                                <span asp-validation-for="@Model.ProjectsViewData.ProjectName" class="text-danger"></span>

                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal"><em class="flaticon-cancel-12"></em> Discard</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>

        </div>
    </div>
</div>



<div class="modal fade bd-example-modal-lg" id="ProjectsModalUpdate" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <form asp-action="AddProject" asp-controller="Customers" enctype="multipart/form-data">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Edit Project</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="hidden" asp-for="@Model.ProjectsViewData.ProjectsId" id="compId" />
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label asp-for="@Model.ProjectsViewData.ProjectName" class="control-label"></label>
                                <input asp-for="@Model.ProjectsViewData.ProjectName" class="form-control" id="ProjectNameId" />
                                <span asp-validation-for="@Model.ProjectsViewData.ProjectName" class="text-danger"></span>

                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal"><em class="flaticon-cancel-12"></em> Discard</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>

        </div>
    </div>
</div>


<div class="modal fade bd-example-modal-lg" id="UploadProposalModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <form asp-action="UploadFile" asp-controller="Home" enctype="multipart/form-data">
                <input type="hidden" asp-for="@Model.UploadedDocumentsData.CustomerId" />
                <input type="hidden" asp-for="@Model.UploadedDocumentsData.ProjectId" />

                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Upload File</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="custom-file-container" data-upload-id="myFirstImage2">
                                <label>Upload (Single File) <a href="javascript:void(0)" class="custom-file-container__image-clear" title="Clear Image">x</a></label>
                                <label class="custom-file-container__custom-file">
                                    <input asp-for="@Model.UploadedDocumentsData.MyImage" class="custom-file-container__custom-file__custom-file-input" accept="doc/*">
                                    <span asp-validation-for="@Model.UploadedDocumentsData.MyImage" class="text-danger"></span>
                                    <input type="hidden" name="MAX_FILE_SIZE" value="10485760" />
                                    <span class="custom-file-container__custom-file__custom-file-control"></span>
                                    @Html.ValidationSummary(false, "", new { @class = "text-danger" })
                                </label>
                                <div class="custom-file-container__image-preview"></div>

                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal"><em class="flaticon-cancel-12"></em> Discard</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>

        </div>
    </div>
</div>


<script src="~/lib/layout/plugins/file-upload/file-upload-with-preview.min.js"></script>
@section Scripts
{
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
    @*<script src="~/lib/layout/plugins/apex/apexcharts.min.js"></script>
        <script src="~/lib/layout/assets/js/dashboard/dash_2.js"></script>*@
    <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
    <script>
        $(document).ready(function () {

            var firstUpload = new FileUploadWithPreview('myFirstImage2');
        });
    </script>
    <script>


        function BindProject(id, ProjectName) {
            document.getElementById('compId').value = "";
            document.getElementById('compId').value = id;
            document.getElementById('ProjectNameId').value = ProjectName;
            return true;
        }

        //function DeleteProject() {
        //    swal({
        //        title: 'Are you sure?',
        //        text: "You won't be able to revert this!",
        //        type: 'warning',
        //        showCancelButton: true,
        //        confirmButtonText: 'Delete',
        //        padding: '2em'
        //    }).then(function (result) {
        //        if (result.value) {
        //            swal(
        //                'Deleted!',
        //                'Your file has been deleted.',
        //                'success'
        //            )
        //        }
        //    })
        //}

        function SetUpload(Customer, ProjectsId) {
            document.getElementById("UploadedDocumentsData_CustomerId").value = Customer;
            document.getElementById("UploadedDocumentsData_ProjectId").value = ProjectsId;
        }

    </script>

}


